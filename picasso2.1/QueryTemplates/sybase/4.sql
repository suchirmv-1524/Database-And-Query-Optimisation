SELECT
	O_ORDERPRIORITY,
	COUNT(*) AS ORDER_COUNT
FROM
	ORDERS
WHERE
	O_TOTALPRICE :varies
	AND EXISTS (
		SELECT
			*
		FROM
			LINEITEM
		WHERE
			L_ORDERKEY = ORDERS.O_ORDERKEY
			AND L_EXTENDEDPRICE :varies
	)
GROUP BY
	O_ORDERPRIORITY
ORDER BY
	O_ORDERPRIORITY

